/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(n){n.fn.categories=function(a,t){var e=function(n){for(var t=a.length-1;t>=0;--t)if(a[t].id==n)return t},l=function(t){var e=n('<div class="'+i.columnClass+'">');i.addable&&s.find("ul").length<i.maxLevels&&e.append('<div class="form-group"><button data-parent="'+t+'" class="'+i.addButtonClass+'">'+i.addButtonHtml+"</button></div>"),e.append('<ul class="'+i.selectClass+'"></ul>');for(var l=a.length,d=0;l>d;d++){var r=a[d];(null===t&&!r.hasOwnProperty("parent")||r.parent==t)&&e.children("ul").append('<li data-id="'+r.id+'"><a href="#">'+r.name+"</a></li>")}return s.append(e)},i=n.extend({selectClass:"nav nav-pills nav-stacked",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",editable:!1,maxLevels:3,onCategoryAdd:function(){},onSelectChange:function(){}},t),s=this;return l(),s.on("click","li",function(){n(this).siblings().removeClass("active"),n(this).addClass("active");var t=n(this).data("id"),s=e(t);n(this).parent().parent().nextAll().remove(),l(t),i.onSelectChange(a[s],s)}),s.on("click",".btn-success",function(){var t=prompt("New category name");if(null!==t&&""!==t.trim()){for(var e={id:0,name:t},l=n(this).data("parent"),s=n(this).parent().siblings("ul"),d=a.length-1;d>=0;--d)a[d].id>=e.id&&(e.id=a[d].id+1);"undefined"!==l&&(e.parent=l),s.append('<li data-id="'+e.id+'"><a href="#">'+e.name+"</a></li>"),a.push(e),i.onCategoryAdd(e,a.length-1)}}),s}}(jQuery);
