/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(a){a.fn.categories=function(n,t){var e=function(a){for(var t=0;t<n.length;t++)if(n[t].id==a)return t},r=function(t){var e=a('<div class="'+i.columnClass+'">');i.addable&&e.append('<div class="form-group"><button data-parent="'+t+'" class="'+i.addButtonClass+'">'+i.addButtonHtml+"</button></div>"),e.append('<ul class="'+i.selectClass+'"></ul>');for(var r=0;r<n.length;r++)category=n[r],(null===t&&!category.hasOwnProperty("parent")||category.parent==t)&&e.children("ul").append('<li data-id="'+category.id+'"><a href="#">'+category.name+"</a></li>");return l.append(e)},i=a.extend({selectClass:"nav nav-pills nav-stacked",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",editable:!1,onCategoryAdd:function(){},onSelectChange:function(){}},t),l=this;return r(),l.on("click","li",function(){a(this).siblings().removeClass("active"),a(this).addClass("active");var t=a(this).data("id");a(this).parent().parent().nextAll().remove();var l=a.grep(n,function(a){return a.parent==t}).length;l>0&&r(t);var s=e(t);i.onSelectChange(n[s],s)}),l.on("click",".btn-success",function(){var t={};t.id=0;for(var e=0;e<n.length;e++){var r=n[e];r.id>=t.id&&(t.id=r.id+1)}if(t.name=prompt("New category name"),null!==t.name&&""!==t.name.trim()){var l=a(this).data("parent");"undefined"!==l&&(t.parent=a(this).data("parent"));var s=a(this).parent().siblings("ul");s.append('<li data-id="'+t.id+'"><a href="#">'+t.name+"</a></li>"),n.push(t),i.onCategoryAdd(t,n.length-1)}}),l}}(jQuery);
