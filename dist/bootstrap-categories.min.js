/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(n){n.fn.categories=function(t,e){var a=function(n){for(var e=t.length-1;e>=0;--e)if(t[e].id==n)return e},i=function(e){var a=n('<div class="'+l.columnClass+'">');l.addable&&s.find("ul").length<l.maxLevels&&a.append('<form data-parent="'+e+'"><div class="form-group"><button class="'+l.addButtonClass+'">'+l.addButtonHtml+"</button></div></form>"),a.append('<ul class="'+l.selectClass+'"></ul>');for(var i=t.length,d=0;i>d;d++){var r=t[d];(null===e&&!r.hasOwnProperty("parent")||r.parent==e)&&a.children("ul").append('<li data-id="'+r.id+'"><a href="#">'+r.name+"</a></li>")}return s.append(a)},l=n.extend({selectClass:"nav nav-pills nav-stacked",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",addable:!1,maxLevels:3,onCategoryAdd:function(){},onSelectChange:function(){}},e),s=this;return i(),s.on("click","li",function(e){e.preventDefault(),n(this).siblings().removeClass("active"),n(this).addClass("active");var s=n(this).data("id"),d=a(s);n(this).parent().parent().nextAll().remove(),i(s),l.onSelectChange(t[d],d)}),s.on("submit","form",function(e){if(e.preventDefault(),0===n(this).children("input").length)n(this).prepend('<input type="text" class="form-control">'),n(this).children("input").focus(),n(this).find("button").css("display","none");else{var a=n(this).find("input").val();if(null!==a&&""!==a.trim()){for(var i={id:0,name:a},s=n(this).data("parent"),d=n(this).siblings("ul"),r=t.length-1;r>=0;--r)t[r].id>=i.id&&(i.id=t[r].id+1);"undefined"!==s&&(i.parent=s),d.append('<li data-id="'+i.id+'"><a href="#">'+i.name+"</a></li>"),t.push(i),n(this).children("input").remove(),n(this).find("button").css("display","inline-block"),l.onCategoryAdd(i,t.length-1)}}}),s}}(jQuery);
