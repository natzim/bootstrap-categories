/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(t){t.fn.categories=function(n,e){var a=function(t){for(var e=n.length-1;e>=0;--e)if(n[e].id==t)return e},i=function(e){var a=t('<div class="'+l.columnClass+'">');l.addable&&s.find("ul").length<l.maxLevels&&a.append('<form data-parent="'+e+'"><div class="form-group"><button class="'+l.addButtonClass+'">'+l.addButtonHtml+"</button></div></form>"),a.append('<ul class="'+l.selectClass+'"></ul>');for(var i=n.length,d=0;i>d;d++){var r=n[d];(null===e&&!r.hasOwnProperty("parent")||r.parent==e)&&a.children("ul").append('<li class="list-group-item" data-id="'+r.id+'">'+r.name+"</li>")}return s.append(a)},l=t.extend({selectClass:"list-group",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",addInputClass:"form-control",addInputPlaceholder:"Category name",removeable:!1,maxLevels:3,onCategoryAdd:function(){},onSelectChange:function(){}},e),s=this;return i(),s.on("click","li",function(e){e.preventDefault(),t(this).siblings().removeClass("active"),t(this).addClass("active");var s=t(this).data("id"),d=a(s);t(this).parent().parent().nextAll().remove(),i(s),l.onSelectChange(n[d],d)}),s.on("submit","form",function(e){if(e.preventDefault(),0===t(this).children("input").length)t(this).prepend('<input type="text" placeholder="'+l.addInputPlaceholder+'" class="'+l.addInputClass+'">'),t(this).children("input").focus(),t(this).find("button").css("display","none");else{var a=t(this).find("input").val();if(null!==a&&""!==a.trim()){for(var i={id:0,name:a},s=t(this).data("parent"),d=t(this).siblings("ul"),r=n.length-1;r>=0;--r)n[r].id>=i.id&&(i.id=n[r].id+1);"undefined"!==s&&(i.parent=s),d.append('<li class="list-group-item" data-id="'+i.id+'">'+i.name+"</li>"),n.push(i),t(this).children("input").remove(),t(this).find("button").css("display","inline-block"),l.onCategoryAdd(i,n.length-1)}}}),s}}(jQuery);
