/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(t){t.fn.categories=function(e,n){var a=function(t){for(var n=0;n<e.length;n++)if(e[n].id==t)return n},o=function(n){var a=t('<div class="'+r.columnClass+'">');r.addable&&a.append('<div class="form-group"><button data-parent="'+n+'" class="'+r.addButtonClass+'">'+r.addButtonHtml+"</button></div>"),a.append('<select multiple class="'+r.selectClass+'"></select>');for(var o=0;o<e.length;o++)category=e[o],null===n?category.hasOwnProperty("parent")||a.children("select").append('<option data-id="'+category.id+'">'+category.name+"</option>"):category.parent==n&&a.children("select").append('<option data-id="'+category.id+'">'+category.name+"</option>");return d.append(a)},r=t.extend({selectClass:"form-control",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",editable:!1,onCategoryAdd:function(){},onSelectChange:function(){}},n),d=this;return o(),d.on("change","select",function(){var n=t(this).children("option:selected"),d=n.data("id");t(this).parent().nextAll().remove();var i=t.grep(e,function(t){return t.parent==d}).length;i>0&&o(d);var c=a(d);r.onSelectChange(e[c],c)}),d.on("click",".btn-success",function(){var n={};n.id=0;for(var a=0;a<e.length;a++){var o=e[a];o.id>=n.id&&(n.id=o.id+1)}n.name=prompt("New category name");var d=t(this).data("parent");"undefined"!==d&&(n.parent=t(this).data("parent"));var i=t(this).parent().siblings("select");i.append('<option data-id="'+n.id+'">'+n.name+"</button>"),e.push(n),r.onCategoryAdd(n,e.length-1)}),d}}(jQuery);
