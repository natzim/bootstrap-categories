/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(t){t.fn.categories=function(n,e){var a=function(t){for(var e=0;e<n.length;e++)if(n[e].id==t)return e},o=function(e){var a=t('<div class="'+r.columnClass+'">');r.addable&&a.append('<div class="form-group"><button data-parent="'+e+'" class="'+r.addButtonClass+'">'+r.addButtonHtml+"</button></div>"),a.append('<select multiple class="'+r.selectClass+'"></select>');for(var o=0;o<n.length;o++)category=n[o],(null===e&&!category.hasOwnProperty("parent")||category.parent==e)&&a.children("select").append('<option data-id="'+category.id+'">'+category.name+"</option>");return d.append(a)},r=t.extend({selectClass:"form-control",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",editable:!1,onCategoryAdd:function(){},onSelectChange:function(){}},e),d=this;return o(),d.on("change","select",function(){var e=t(this).children("option:selected"),d=e.data("id");t(this).parent().nextAll().remove();var s=t.grep(n,function(t){return t.parent==d}).length;s>0&&o(d);var c=a(d);r.onSelectChange(n[c],c)}),d.on("click",".btn-success",function(){var e={};e.id=0;for(var a=0;a<n.length;a++){var o=n[a];o.id>=e.id&&(e.id=o.id+1)}e.name=prompt("New category name");var d=t(this).data("parent");"undefined"!==d&&(e.parent=t(this).data("parent"));var s=t(this).parent().siblings("select");s.append('<option data-id="'+e.id+'">'+e.name+"</button>"),n.push(e),r.onCategoryAdd(e,n.length-1)}),d}}(jQuery);
