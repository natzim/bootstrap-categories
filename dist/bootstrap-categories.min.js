/*
 * Bootstrap Categories
 *
 * @author Nat Zimmermann <nat@natzim.me>
 * @license MIT
 */
!function(n){n.fn.categories=function(t,a){var e=function(n){for(var a=t.length-1;a>=0;--a)if(t[a].id==n)return a},l=function(a){var e=n('<div class="'+i.columnClass+'">');i.addable&&d.find("ul").length<i.maxLevels&&e.append('<form data-parent="'+a+'"><div class="form-group"><button class="'+i.addButtonClass+'">'+i.addButtonHtml+"</button></div></form>"),e.append('<ul class="'+i.selectClass+'"></ul>');for(var l=t.length,s=0;l>s;s++){var r=t[s];(null===a&&!r.hasOwnProperty("parent")||r.parent==a)&&e.children("ul").append('<li data-id="'+r.id+'"><a href="#">'+r.name+"</a></li>")}return d.append(e)},i=n.extend({selectClass:"nav nav-pills nav-stacked",columnClass:"col-md-4",addButtonClass:"btn btn-success",addButtonHtml:"+",addInputClass:"form-control",addInputPlaceholder:"Category name",addable:!1,maxLevels:3,onCategoryAdd:function(){},onSelectChange:function(){}},a),d=this;return l(),d.on("click","li",function(a){a.preventDefault(),n(this).siblings().removeClass("active"),n(this).addClass("active");var d=n(this).data("id"),s=e(d);n(this).parent().parent().nextAll().remove(),l(d),i.onSelectChange(t[s],s)}),d.on("submit","form",function(a){if(a.preventDefault(),0===n(this).children("input").length)n(this).prepend('<input type="text" placeholder="'+i.addInputPlaceholder+'" class="'+i.addInputClass+'">'),n(this).children("input").focus(),n(this).find("button").css("display","none");else{var e=n(this).find("input").val();if(null!==e&&""!==e.trim()){for(var l={id:0,name:e},d=n(this).data("parent"),s=n(this).siblings("ul"),r=t.length-1;r>=0;--r)t[r].id>=l.id&&(l.id=t[r].id+1);"undefined"!==d&&(l.parent=d),s.append('<li data-id="'+l.id+'"><a href="#">'+l.name+"</a></li>"),t.push(l),n(this).children("input").remove(),n(this).find("button").css("display","inline-block"),i.onCategoryAdd(l,t.length-1)}}}),d}}(jQuery);
